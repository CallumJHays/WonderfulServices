<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8"> 
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<script src="js/jquery.js"></script>
		<script src="js/moment-with-locales.js"></script>
		<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css"></link>
		<script src="bootstrap/js/bootstrap.js"></script>
		<script src="js/bootbox.min.js"></script>
		<link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css"></link>
		<script src="js/bootstrap-datetimepicker.min.js"></script>
		<script type="text/javascript"> // credit to Bubelbub
		// @ http://bootsnipp.com/snippets/featured/dynamic-form-fields-add-amp-remove-bs3
			$(function()
			{
			    $(document).on('click', '.btn-add', function(e) // handle dynamic vehicle list form add vehicle
			    {
			        e.preventDefault();

			        var controlForm = $('.controls'),
			            currentEntry = $(this).parents('.entry:first'),
			            newEntry = $(currentEntry.clone()).appendTo(controlForm);

			        newEntry.find('.serviceSelect').val("Ext");
			        controlForm.find('.entry:not(:last) .btn-add')
			            .removeClass('btn-add').addClass('btn-remove')
			            .removeClass('btn-success').addClass('btn-danger')
			            .html('<span class="glyphicon glyphicon-minus"></span>');
			    }).on('click', '.btn-remove', function(e)
			    {
			    	var $element = $(this); //cant query 'this' within next function
			    	bootbox.confirm("Remove vehicle - Are you sure?", function(result){
			    		if(result){
							$element.parents('.entry:first').remove();

							e.preventDefault();
			    		}
			    	});
				});

				$('.serviceSelect').change(function(e){
					e.preventDefault();
						
					if($(this).val() == "Exterior Only"){
						$(this).parents('.entry:first').find('#hasPet:first').remove();
					}
					else{ //handle interior
						if($(this).parents('.entry:first').find('#hasPet').length == 0){ // if it already exists
							console.log
							$("<div class='col-sm-1'></div>")
								.html("<div class='col-sm-2'><label for='hasPet'>Has Pet?</label>
									<input type='checkbox' id='hasPet'></div>")
								.insertAfter($(this).parents('.entry:first').find('.serviceSelect').parent());
						}
					}
				});
			});
		</script>
		<style>
			.entry:not(:first-of-type)
			{
			    margin-top: 10px;
			}

			.glyphicon
			{
			    font-size: 12px;
			}
		</style>

	</head>

	<body>
		<div class="container">
			<h1>Wonderful Services Booking</h1>
			<p>Hi! Welcome to wonderful services.</p>

			<form class="form-horizontal" role="form">

				<div class="row">
			        <div class="form-group controls">
			            <label class="control-label col-sm-offset-1" for="entry">Vehicle List:</label>
	                    <div class="well entry input-group col-sm-11 col-sm-offset-1">
	                    	<div class="col-sm-3">
	                    		<label class="control-label" for="vehicleType[]">Vehicle Type</label>
		                        <select class="form-control" id="vehicleType[]">
		                        	<option>Sedan</option>
		                        	<option>Hatchback</option>
		                        	<option>Ambulance</option>
		                        </select>
	                        </div>
	                        <div class="col-sm-3">
	                        	<label class="control-label" for="service[]">Service</label>
	                        	<select class="serviceSelect form-control" id="service[]">
	                        		<option>Exterior Only</option>
	                        		<option>Interior Only</option>
	                        		<option>Full Detail</option>
                        		</select>
                        	</div>
	                    	<span class="input-group-btn">
	                            <button class="btn btn-success btn-add" type="button">
	                                <span class="glyphicon glyphicon-plus"></span>
	                            </button>
	                        </span>
	                    </div>
			        </div>
				</div>
				<br>

				<div class="row">
		            <div class="form-group"> <!-- Booking datetimepicker -->
	                	<label class="control-label col-sm-2" for="bookingpicker">Booking date & time:</label>
	                	<div class='col-sm-10'>
			                <div class='input-group date' id='bookingpicker'>
			                    <input type='text' class="form-control" />
			                    <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
		                    </div>
	                    </div>
				        <script type="text/javascript">
				            $(function () {
				            	var finishtime = "4:30"; // make automatically calculated
				            	var fullyBookedDates = []; // use database to populate
				                $('#bookingpicker').datetimepicker({
				                	daysOfWeekDisabled: [0, 6],
				                	format: "dddd, MMMM Do, h:mma - " + finishtime,
				                	stepping: 15,
				                	minDate: moment().add(3, 'day').day(8).hour(9).minute(0),
				                	disabledDates: fullyBookedDates,
				                	sideBySide: true, 
				                	enabledHours: [9,10,11,12,13,14,15]// Change as necessary
				                });
				            });
				        </script>
					</div>
				</div>
				<br>

				<div class="row">
					<div class="form-group">
						<label class="control-label col-sm-2" for="name">Name:</label>
						<div class="col-sm-10"> 
							<input type="text" class="form-control" id="name" placeholder="Enter name">
						</div>
					</div>
				</div>
				<br>

				<div class="row">
					<div class="form-group"> 
						<div class="col-sm-offset-2 col-sm-10">
							<button type="submit" class="btn btn-default">Submit</button>
						</div>
					</div>
				</div>
				<br>

			</form>
		</div>
	</body>
</html>